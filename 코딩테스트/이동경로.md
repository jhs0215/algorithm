```cpp
#include <string>
#include <list>
#include <vector>
#include <queue>
#include <map>
#include <unordered_set>
#include <unordered_map>
#include <array>
#include <algorithm>
#include <functional> 

using namespace std;

int solution(string dirs) {
	int answer = 0;

	pair<int, int> pos{0, 0};
	map<pair<int, int>, vector<pair<int, int>>> count;

	for (auto idx = 0; idx < dirs.length(); ++idx)
	{
		if (dirs[idx] == 'L')
		{
			if (pos.first - 1 < -5)
				continue;

			pair<int, int> l{-1, 0}, r{1, 0};
			pair<int, int> next{pos.first - 1, pos.second};

			auto it = find(count[pos].begin(), count[pos].end(), l);
			if (it == count[pos].end())
			{
				answer++;
				count[pos].push_back(l);
				count[next].push_back(r);
			}

			pos = next;
		}
		else if (dirs[idx] == 'R')
		{
			if (pos.first + 1 > 5)
				continue;

			pair<int, int> l{-1, 0}, r{1, 0};
			pair<int, int> next{pos.first + 1, pos.second};

			auto it = find(count[pos].begin(), count[pos].end(), r);
			if (it == count[pos].end())
			{
				answer++;
				count[pos].push_back(r);
				count[next].push_back(l);
			}

			pos = next;
		}
		else if (dirs[idx] == 'U')
		{
			if (pos.second + 1 > 5)
				continue;

			pair<int, int> u{0, 1}, d{0, -1};
			pair<int, int> next{pos.first, pos.second + 1};

			auto it = find(count[pos].begin(), count[pos].end(), u);
			if (it == count[pos].end())
			{
				answer++;
				count[pos].push_back(u);
				count[next].push_back(d);
			}

			pos = next;
		}
		else if (dirs[idx] == 'D')
		{
			if (pos.second - 1 < -5)
				continue;

			pair<int, int> u{0, 1}, d{0, -1};
			pair<int, int> next{pos.first, pos.second - 1};

			auto it = find(count[pos].begin(), count[pos].end(), d);
			if (it == count[pos].end())
			{
				answer++;
				count[pos].push_back(d);
				count[next].push_back(u);
			}

			pos = next;
		}
	}

	return answer;
}

int main()
{
	string dirs = "ULURRDLLU";
	solution(dirs);

	return 0;
}
```